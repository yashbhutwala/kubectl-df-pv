version: 2

project_name: kubectl-df-pv

release:
  github:
    owner: yashbhutwala
    name: kubectl-df-pv

builds:
  - id: df-pv
    main: cmd/df-pv/main.go
    binary: df-pv
    env:
      - CGO_ENABLED=0
    goos:
      - linux
      - windows
      - darwin
    goarch:
      - amd64
      - arm64
      - "386"
    flags:
      - -tags=netgo
      - -installsuffix
      - netgo
    ldflags:
      - -s -w
      - -X github.com/yashbhutwala/kubectl-df-pv/pkg/version.version={{.Version}}
      - -X github.com/yashbhutwala/kubectl-df-pv/pkg/version.gitSHA={{.Commit}}
      - -X github.com/yashbhutwala/kubectl-df-pv/pkg/version.buildTime={{.Date}}
      - -extldflags "-static"

# Let GoReleaser choose defaults per-OS (tar.gz for unix, zip for windows),
# while ensuring common docs are embedded in the archives.
archives:
  - name_template: '{{ .ProjectName }}_{{ .Tag }}_{{ .Os }}_{{ .Arch }}{{ if .Arm }}v{{ .Arm }}{{ end }}'
    formats: ["tar.gz"]
    format_overrides:
      - goos: windows
        formats: ["zip"]
    files:
      - licence*
      - LICENCE*
      - license*
      - LICENSE*
      - readme*
      - README*
      - changelog*
      - CHANGELOG*
